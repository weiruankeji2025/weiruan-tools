<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPG è½¬ PNG å·¥å…·</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="navbar">
    <a href="index.html" class="nav-link active">ğŸ–¼ï¸ å›¾ç‰‡è½¬æ¢</a>
    <a href="video.html" class="nav-link">ğŸ¬ è§†é¢‘è½¬GIF</a>
</nav>
    <h1>ğŸ–¼ï¸ å›¾ç‰‡æ ¼å¼è½¬æ¢å™¨</h1>
    
    <div class="container">
        <p>é€‰æ‹©ä¸€å¼  JPG å›¾ç‰‡ï¼Œå·¥å…·å°†è‡ªåŠ¨å°†å…¶è½¬æ¢ä¸ºæ— æŸ PNG æ ¼å¼ã€‚</p>
        
        <input type="file" id="upload" accept="image/jpeg, image/jpg">
        
        <canvas id="canvas" style="display:none;"></canvas>
        
        <img id="preview" alt="é¢„è§ˆå°†åœ¨è¿™é‡Œæ˜¾ç¤º" style="display:none;">
        
        <br>
        <a id="downloadLink" class="btn" style="display:none;">ä¸‹è½½ PNG</a>
    </div>

    <script>
        const upload = document.getElementById('upload');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const preview = document.getElementById('preview');
        const downloadLink = document.getElementById('downloadLink');

        upload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const img = new Image();
            const reader = new FileReader();

            reader.onload = (event) => {
                img.src = event.target.result;
            };

            img.onload = () => {
                // è®¾ç½®ç”»å¸ƒå°ºå¯¸ä¸åŸå›¾ä¸€è‡´
                canvas.width = img.width;
                canvas.height = img.height;
                
                // ç»˜åˆ¶å›¾ç‰‡
                ctx.drawImage(img, 0, 0);
                
                // è½¬æ¢ä¸º PNG DataURL
                const pngUrl = canvas.toDataURL('image/png');
                
                // æ˜¾ç¤ºé¢„è§ˆ
                preview.src = pngUrl;
                preview.style.display = 'block';

                // è®¾ç½®ä¸‹è½½æŒ‰é’®ä¿¡æ¯
                downloadLink.href = pngUrl;
                // ç”Ÿæˆæ–°æ–‡ä»¶åï¼šåŸæ–‡ä»¶åå»æ‰åç¼€ + _converted.png
                downloadLink.download = file.name.replace(/\.(jpg|jpeg)$/i, '') + '_converted.png';
                downloadLink.style.display = 'inline-block';
                downloadLink.textContent = 'ä¸‹è½½ PNG (' + (pngUrl.length/1024).toFixed(0) + 'KB)';
            };

            reader.readAsDataURL(file);
        });
    </script>
</body>

</html>
